# se-invigilation-vue


### Update
#### 2023.10.30
优化组件渲染速度，大工具类文件在函数执行而非组件加载时加载。  
优化监考分配数据，整合到一次循环实现，但逻辑是否清晰？代码是否过于复杂不利于维护？  
重新分配时，将原分配单列并置顶，使信息更清晰。  
优化表格显示效果。  
修复检索时date-picker组件时间类型bug。默认Date转ISO有+8时差，总忘。还是转为使用字符串类型方便。  
修复栅格在小屏幕下视图组件CSS叠加覆盖bug。   
修复已下发未分配中包含未下发数据bug。  


#### 2023.10.17
添加免密登录。  
免密入口文本描述调用随机诗词接口，活跃一下疲劳的工作气氛。  
悬浮在监考各过程操作人员姓名时显示操作时间。   
监考重新分配时，按原分配默认选中。  
导入需下发状态监考比较重要，单独取消分页。  
添加`处理`模块，基于重要监考信息操作。支持按日期(默认7日)检索/按状态过滤/按专业分组，便于掌握监考下发分配情况。  
修复课表读取单周时仅基于长度判断的bug。   
优化课表表格读取；将复杂的正则表达式匹配替换为按数组分割。   
JS toLocaleString()函数，不同浏览器有不同实现，firefox使用本地语言中文`下午`描述。  

#### 2023.10.15
一个破课表也能弄出N个版本的格式

### Others
实现了抽象的设计  
在响应拦截器添加递归过滤函数，将属性中MySQL JSON字段返回的字符串直接序列化为JS对象，避免了在业务逻辑手动转换。  
设计slot实现数据相似但部分实现功能不同的表格的渲染。  

实现带关闭回调的全局通用确认框。


### Thinking
**打包拆分**  
按Java的编程习惯，一类相关操作会封装到一个工具类/组件中，但是后端仅有编译，不涉及到打包的文件拆分。  
前端项目默认以模块(文件)为单位打包，但是当编写了一个较大的工具模块时，引用的组件模块会加载整个工具模块，
而非在打包时将模块需要的工具函数分割。即，即时仅需使用工具模块中的一个函数，也需要加载整个模块，从而影响渲染速度。  

即，以粗粒度的功能分类模块是否利于打包部署？以细粒度的操作函数的分类又会产生大量文件，是否利于维护？  
打包时，是否能自动分割函数为独立模块文件打包？


**设计思想**  
视图组件设计为阻塞组件，加载后调用业务组件获取数据并阻塞等待；  
业务组件基于需求从本地store缓存/远程加载数据，数据加载后置于store缓存或直接返回视图组件；  

同步组件设计更直观简洁，避免了原设计中大量使用响应应式数据/store响应式数据/监听回调等。  

**store应该缓存什么数据的纠结**  
多次发生更新后数据不变，刷新就没问题了，发现是大量使用缓存导致的。  

一个组件需要从网络拉取一组数据渲染；切换到别的组件再切回来，当然不希望再从网络拉取，所以组件加载时先去store找，没有再网络请求，放store。优点，减少网络请求，提高效率。

但这些数据可能会被更新，比如加了一条，则需要从数据库重新拉取，要不没主键，需清空store否则组件加载还使用store中旧数据；还有，修改元素数据状态等等，可能都需要清store，不清在逻辑中修改store数据更麻烦。这样对一些数据修改的业务逻辑就非常非常不利于维护，总要想着是否影响了缓存数据并更新。

那这组数据是否应置于store缓存？如何平衡效率与可维护性？  

除非涉及大量IO操作，否则网络带宽/CPU运算频率/内存/磁盘容量等等都可以靠堆硬件解决，还是觉得项目的可维护性应大于网络请求效率。



